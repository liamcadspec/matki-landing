<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Launching Matki Smart Survey…</title>

    <script>
        const params = new URLSearchParams(window.location.search);
        const driveItemId = params.get("driveItemId");
        const fileName = params.get("fileName");

        console.log("driveItemId:", driveItemId);
        console.log("fileName:", fileName);

        if (!driveItemId || !fileName) {
            document.body.innerHTML = "<p style='color:red;'>Missing required parameters. Cannot launch Matki Smart Survey.</p>";
            throw new Error("Missing deep link parameters");
        }

        //capture the SharePoint share URL from the referrer
        const shareUrl = document.referrer;
        console.log("shareUrl:", shareUrl);

        if (!shareUrl) {
            document.body.innerHTML = "<p style='color:red;'>Missing SharePoint referrer. Cannot launch Matki Smart Survey.</p>";
            throw new Error("Missing shareUrl");
        }

        // Build the deep link
        const deepLink =
            `matzip://open?driveItemId=${encodeURIComponent(driveItemId)}` +
            `&fileName=${encodeURIComponent(fileName)}` +
            `&shareUrl=${encodeURIComponent(shareUrl)}`;

        window.location.href = deepLink;
    </script>
</head>
<body>
    <p>Launching Matki Smart Survey…</p>
</body>
</html>






